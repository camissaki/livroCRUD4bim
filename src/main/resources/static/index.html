<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>üìö Biblioteca Digital</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
    <header>
        <h1>üìö Biblioteca Digital</h1>
        <p>Sistema de Gerenciamento de Livros</p>
    </header>

    <div class="section">
        <h2>üìñ Cadastrar Novo Livro</h2>
        <div class="form-group">
            <input type="text" id="titulo" placeholder="T√≠tulo do Livro" required>
            <input type="text" id="autor" placeholder="Autor" required>
            <input type="text" id="isbn" placeholder="ISBN (opcional)">
            <input type="number" id="anoPublicacao" placeholder="Ano de Publica√ß√£o" min="1000" max="2024">
            <input type="text" id="genero" placeholder="G√™nero (ex: Fic√ß√£o, Romance, etc.)">
            <input type="text" id="editora" placeholder="Editora">
            <textarea id="descricao" placeholder="Descri√ß√£o do livro (opcional)" rows="3"></textarea>
            <button onclick="criar()" class="btn-primary">üìö Cadastrar Livro</button>
        </div>
    </div>

    <div class="section">
        <h2>üîç Buscar Livros</h2>
        <div class="search-options">
            <div class="search-group">
                <h3>Por T√≠tulo</h3>
                <input type="text" id="buscarTitulo" placeholder="Digite o t√≠tulo">
                <button onclick="buscarPorTitulo()" class="btn-secondary">üîç Buscar</button>
            </div>
            
            <div class="search-group">
                <h3>Por Autor</h3>
                <input type="text" id="buscarAutor" placeholder="Digite o autor">
                <button onclick="buscarPorAutor()" class="btn-secondary">üë§ Buscar</button>
            </div>
            
            <div class="search-group">
                <h3>Por G√™nero</h3>
                <input type="text" id="buscarGenero" placeholder="Digite o g√™nero">
                <button onclick="buscarPorGenero()" class="btn-secondary">üìÇ Buscar</button>
            </div>
            
            <div class="search-group">
                <h3>Todos os Livros</h3>
                <button onclick="buscarTodos()" class="btn-secondary">üìã Listar Todos</button>
            </div>
        </div>
        <pre id="resultadoBuscar"></pre>
    </div>

    <div class="section">
        <h2>üóëÔ∏è Deletar Livro</h2>
        <div class="form-group">
            <input type="number" id="deletarId" placeholder="ID do livro para deletar">
            <button onclick="deletarPorId()" class="btn-danger">üóëÔ∏è Deletar por ID</button>
        </div>
    </div>

    <div class="section">
        <h2>‚úèÔ∏è Atualizar Livro</h2>
        <div class="form-group">
            <input type="number" id="id" placeholder="ID do livro" required>
            <input type="text" id="novoTitulo" placeholder="Novo T√≠tulo">
            <input type="text" id="novoAutor" placeholder="Novo Autor">
            <input type="text" id="novoIsbn" placeholder="Novo ISBN">
            <input type="number" id="novoAnoPublicacao" placeholder="Novo Ano de Publica√ß√£o" min="1000" max="2024">
            <input type="text" id="novoGenero" placeholder="Novo G√™nero">
            <input type="text" id="novoEditora" placeholder="Nova Editora">
            <textarea id="novaDescricao" placeholder="Nova Descri√ß√£o" rows="3"></textarea>
            <button onclick="atualizar()" class="btn-warning">‚úèÔ∏è Atualizar Livro</button>
        </div>
    </div>
</div>

<script>
    const api = "/livro";

    async function criar() {
        const livro = {
            titulo: document.getElementById("titulo").value,
            autor: document.getElementById("autor").value,
            isbn: document.getElementById("isbn").value,
            anoPublicacao: document.getElementById("anoPublicacao").value ? parseInt(document.getElementById("anoPublicacao").value) : null,
            genero: document.getElementById("genero").value,
            editora: document.getElementById("editora").value,
            descricao: document.getElementById("descricao").value
        };

        if (!livro.titulo || !livro.autor) {
            alert("T√≠tulo e Autor s√£o obrigat√≥rios!");
            return;
        }

        const resp = await fetch(api, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(livro)
        });
        
        if (resp.ok) {
            alert("üìö Livro cadastrado com sucesso!");
            limparFormulario();
        } else {
            alert("‚ùå Erro ao cadastrar livro!");
        }
    }

    async function buscarPorTitulo() {
        const titulo = document.getElementById("buscarTitulo").value;
        if (!titulo) {
            alert("Digite um t√≠tulo para buscar!");
            return;
        }
        
        const resp = await fetch(`${api}?titulo=${encodeURIComponent(titulo)}`);
        if (resp.ok) {
            const data = await resp.json();
            document.getElementById("resultadoBuscar").innerText = JSON.stringify(data, null, 2);
        } else {
            document.getElementById("resultadoBuscar").innerText = "‚ùå Livro n√£o encontrado!";
        }
    }

    async function buscarPorAutor() {
        const autor = document.getElementById("buscarAutor").value;
        if (!autor) {
            alert("Digite um autor para buscar!");
            return;
        }
        
        const resp = await fetch(`${api}/autor?autor=${encodeURIComponent(autor)}`);
        if (resp.ok) {
            const data = await resp.json();
            document.getElementById("resultadoBuscar").innerText = JSON.stringify(data, null, 2);
        } else {
            document.getElementById("resultadoBuscar").innerText = "‚ùå Nenhum livro encontrado para este autor!";
        }
    }

    async function buscarPorGenero() {
        const genero = document.getElementById("buscarGenero").value;
        if (!genero) {
            alert("Digite um g√™nero para buscar!");
            return;
        }
        
        const resp = await fetch(`${api}/genero?genero=${encodeURIComponent(genero)}`);
        if (resp.ok) {
            const data = await resp.json();
            document.getElementById("resultadoBuscar").innerText = JSON.stringify(data, null, 2);
        } else {
            document.getElementById("resultadoBuscar").innerText = "‚ùå Nenhum livro encontrado para este g√™nero!";
        }
    }

    async function buscarTodos() {
        const resp = await fetch(`${api}/all`);
        if (resp.ok) {
            const data = await resp.json();
            document.getElementById("resultadoBuscar").innerText = JSON.stringify(data, null, 2);
        } else {
            document.getElementById("resultadoBuscar").innerText = "‚ùå Erro ao buscar livros!";
        }
    }


    async function deletarPorId() {
        const id = document.getElementById("deletarId").value;
        if (!id) {
            alert("Digite um ID para deletar!");
            return;
        }
        
        const resp = await fetch(`${api}/${id}`, { method: "DELETE" });
        if (resp.ok) {
            alert("üóëÔ∏è Livro deletado com sucesso!");
        } else {
            alert("‚ùå Erro ao deletar livro!");
        }
    }

    async function atualizar() {
        const id = document.getElementById("id").value;
        if (!id) {
            alert("Digite um ID para atualizar!");
            return;
        }

        const livro = {
            titulo: document.getElementById("novoTitulo").value,
            autor: document.getElementById("novoAutor").value,
            isbn: document.getElementById("novoIsbn").value,
            anoPublicacao: document.getElementById("novoAnoPublicacao").value ? parseInt(document.getElementById("novoAnoPublicacao").value) : null,
            genero: document.getElementById("novoGenero").value,
            editora: document.getElementById("novoEditora").value,
            descricao: document.getElementById("novaDescricao").value
        };

        const resp = await fetch(`${api}/${id}`, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(livro)
        });
        
        if (resp.ok) {
            alert("‚úèÔ∏è Livro atualizado com sucesso!");
            limparFormularioAtualizacao();
        } else {
            alert("‚ùå Erro ao atualizar livro!");
        }
    }

    function limparFormulario() {
        document.getElementById("titulo").value = "";
        document.getElementById("autor").value = "";
        document.getElementById("isbn").value = "";
        document.getElementById("anoPublicacao").value = "";
        document.getElementById("genero").value = "";
        document.getElementById("editora").value = "";
        document.getElementById("descricao").value = "";
    }

    function limparFormularioAtualizacao() {
        document.getElementById("id").value = "";
        document.getElementById("novoTitulo").value = "";
        document.getElementById("novoAutor").value = "";
        document.getElementById("novoIsbn").value = "";
        document.getElementById("novoAnoPublicacao").value = "";
        document.getElementById("novoGenero").value = "";
        document.getElementById("novoEditora").value = "";
        document.getElementById("novaDescricao").value = "";
    }
</script>
</body>
</html>
